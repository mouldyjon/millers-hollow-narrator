import type { Role } from "../types/game";

export const roles: Record<string, Role> = {
  villager: {
    id: "villager",
    name: "Villager",
    team: "village",
    description: "Simple villager with no special powers",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: true,
    maxQuantity: 9,
  },
  "two-sisters": {
    id: "two-sisters",
    name: "Two Sisters",
    team: "village",
    description: "Recognise each other on the first night",
    nightOrder: 999,
    nightOrderFirstNight: 2,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
    maxQuantity: 2,
  },
  "three-brothers": {
    id: "three-brothers",
    name: "Three Brothers",
    team: "village",
    description: "Recognise each other on the first night",
    nightOrder: 999,
    nightOrderFirstNight: 3,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
    maxQuantity: 3,
  },
  seer: {
    id: "seer",
    name: "Seer",
    team: "village",
    description: "Can spy on one player each night to learn their identity",
    nightOrder: 4,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  witch: {
    id: "witch",
    name: "Witch",
    team: "village",
    description:
      "Has one healing potion and one death potion to use during the game",
    nightOrder: 7,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: true,
    allowMultiple: false,
  },
  hunter: {
    id: "hunter",
    name: "Hunter",
    team: "village",
    description: "When eliminated, can shoot another player",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "little-girl": {
    id: "little-girl",
    name: "Little Girl",
    team: "village",
    description: "Can spy on the werewolves during their turn",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  cupid: {
    id: "cupid",
    name: "Cupid",
    team: "village",
    description: "Chooses two lovers on the first night",
    nightOrder: 999,
    nightOrderFirstNight: 1.5,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "knight-rusty-sword": {
    id: "knight-rusty-sword",
    name: "Knight with Rusty Sword",
    team: "village",
    description: "Infects one werewolf when devoured",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "stuttering-judge": {
    id: "stuttering-judge",
    name: "Stuttering Judge",
    team: "village",
    description: "Can force two consecutive votes once per game",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: true,
    allowMultiple: false,
  },
  fox: {
    id: "fox",
    name: "Fox",
    team: "village",
    description: "Can investigate groups of three players each night",
    nightOrder: 8,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "bear-tamer": {
    id: "bear-tamer",
    name: "Bear Tamer",
    team: "village",
    description: "Bear grunts at dawn if a werewolf is adjacent",
    nightOrder: 999, // No night action - effect happens at dawn
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "devoted-servant": {
    id: "devoted-servant",
    name: "Devoted Servant",
    team: "village",
    description: "Can take the role of an eliminated player",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  actor: {
    id: "actor",
    name: "Actor",
    team: "village",
    description: "Uses powers from three pre-selected cards each night",
    nightOrder: 10,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "simple-werewolf": {
    id: "simple-werewolf",
    name: "Simple Werewolf",
    team: "werewolf",
    description: "Wakes with other werewolves to choose a victim",
    nightOrder: 5,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: true,
    maxQuantity: 4,
  },
  "big-bad-wolf": {
    id: "big-bad-wolf",
    name: "Big Bad Wolf",
    team: "werewolf",
    description: "Can devour an extra victim until a werewolf dies",
    nightOrder: 6,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "white-werewolf": {
    id: "white-werewolf",
    name: "White Werewolf",
    team: "werewolf",
    description: "Can kill another werewolf every other night, wins alone",
    nightOrder: 5.5,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "cursed-wolf-father": {
    id: "cursed-wolf-father",
    name: "Cursed Wolf-Father",
    team: "werewolf",
    description: "Can infect one victim once per game to become a werewolf",
    nightOrder: 6.5,
    wakeEveryNight: true,
    wakeFirstNightOnly: false,
    hasLimitedUse: true,
    allowMultiple: false,
  },
  angel: {
    id: "angel",
    name: "Angel",
    team: "solo",
    description: "Wins if eliminated first day/night, then becomes villager",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "prejudiced-manipulator": {
    id: "prejudiced-manipulator",
    name: "Prejudiced Manipulator",
    team: "solo",
    description:
      "Divides village into groups, wins if opposing group eliminated",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "wild-child": {
    id: "wild-child",
    name: "Wild Child",
    team: "village",
    description:
      "Chooses role model on first night, becomes werewolf if model dies",
    nightOrder: 999,
    nightOrderFirstNight: 1.8,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  "wolf-hound": {
    id: "wolf-hound",
    name: "Wolf-Hound",
    team: "village",
    description: "Chooses to be villager or werewolf on first night",
    nightOrder: 999,
    nightOrderFirstNight: 1.3,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  thief: {
    id: "thief",
    name: "Thief",
    team: "village",
    description: "Can swap card with unused roles on first night",
    nightOrder: 999,
    nightOrderFirstNight: 1,
    wakeEveryNight: false,
    wakeFirstNightOnly: true,
    hasLimitedUse: false,
    allowMultiple: false,
  },
  sheriff: {
    id: "sheriff",
    name: "Sheriff",
    team: "village",
    description: "Elected during day phase, has special voting power",
    nightOrder: 999,
    wakeEveryNight: false,
    wakeFirstNightOnly: false,
    hasLimitedUse: false,
    allowMultiple: false,
  },
};

export const rolesByNightOrder = (isFirstNight: boolean) => {
  return Object.values(roles)
    .filter((role) => {
      if (isFirstNight) {
        return role.wakeFirstNightOnly || role.wakeEveryNight;
      }
      return role.wakeEveryNight;
    })
    .sort((a, b) => {
      const orderA =
        isFirstNight && a.nightOrderFirstNight !== undefined
          ? a.nightOrderFirstNight
          : a.nightOrder;
      const orderB =
        isFirstNight && b.nightOrderFirstNight !== undefined
          ? b.nightOrderFirstNight
          : b.nightOrder;
      return orderA - orderB;
    });
};
